var ae=Object.defineProperty;var N=Object.getOwnPropertySymbols;var G=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable;var J=(t,n,r)=>n in t?ae(t,n,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[n]=r,w=(t,n)=>{for(var r in n||(n={}))G.call(n,r)&&J(t,r,n[r]);if(N)for(var r of N(n))K.call(n,r)&&J(t,r,n[r]);return t};var j=(t,n)=>{var r={};for(var o in t)G.call(t,o)&&n.indexOf(o)<0&&(r[o]=t[o]);if(t!=null&&N)for(var o of N(t))n.indexOf(o)<0&&K.call(t,o)&&(r[o]=t[o]);return r};import{c as se,e as le,a as M,S as V,R as e,B as m,I as ce,T as S,b as ie,d as H,u as me,f as Q,F as ue,g as de,h as fe,r as y,l as pe,i as P,C as ge,A as he,j as be,k as Ee,m as Z,n as Ce,o as we,p as xe,q as ve,s as ke,t as Se}from"./vendor.56fc0b47.js";const ye=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))o(a);new MutationObserver(a=>{for(const l of a)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&o(c)}).observe(document,{childList:!0,subtree:!0});function r(a){const l={};return a.integrity&&(l.integrity=a.integrity),a.referrerpolicy&&(l.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?l.credentials="include":a.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function o(a){if(a.ep)return;a.ep=!0;const l=r(a);fetch(a.href,l)}};ye();const Fe=se({sm:"640px",md:"768px",lg:"1024px",xl:"1280px","2xl":"1536px"}),Be=le({breakpoints:Fe});const Re=(t,n)=>{t.emit("command",n)};var x={send:Re};const X={isClosable:!0,duration:5e3,position:"top"},Ie={status:"error",title:"Oops"},Oe={status:"success",title:"Success!!"},Te=M({defaultOptions:X}),Ae=M({defaultOptions:w(w({},X),Ie)}),De=M({defaultOptions:w(w({},X),Oe)});var E={toast:Te,error:Ae,success:De};const U=V.mixin({buttonsStyling:!1,width:"20rem"}),ee=()=>{const t=U.getPopup();return t.classList.remove("swal2-show"),setTimeout(()=>{t.classList.add("animate__animated","animate__headShake")}),setTimeout(()=>{t.classList.remove("animate__animated","animate__headShake")},500),!1},_e=({partner:t,onAccept:n,onDeny:r})=>{U.fire({title:t,html:"<p class='text-purple-500 text-base font-light'>Incoming Call<p>",showConfirmButton:!0,showCancelButton:!0,confirmButtonText:"accept",cancelButtonText:"deny",reverseButtons:!0,allowOutsideClick:ee,backdrop:!0,imageUrl:"/images/call/waving-hand.gif",customClass:{popup:"rounded-lg",image:"w-24 h-24 mt-3 mb-0",title:"font-semibold text-2xl text-purple-500 mt-0 mb-0",htmlContainer:"pt-0",cancelButton:"w-32 h-14 rounded-lg bg-yellow-500 text-white focus:outline-none mr-3",confirmButton:"w-32 h-14 rounded-lg bg-purple-500 text-white focus:outline-none ml-3"}}).then(o=>{o.isConfirmed?n():o.dismiss===V.DismissReason.cancel&&r()})},Le=({partner:t,onCancel:n})=>{U.fire({title:t,html:"<p class='text-purple-500 text-base font-light'>calling<p>",showConfirmButton:!1,showCancelButton:!0,cancelButtonText:"Cancel Call",reverseButtons:!1,allowOutsideClick:ee,backdrop:!0,imageUrl:"/images/call/call-me-hand.gif",customClass:{popup:"rounded-lg",image:"w-24 h-24 mt-3 mb-0",title:"font-semibold text-2xl text-purple-500 mt-0 mb-0",htmlContainer:"pt-0",cancelButton:"w-72 h-14 rounded-lg bg-yellow-500 text-white focus:outline-none"}}).then(r=>{r.dismiss===V.DismissReason.cancel&&n()})};var B={swalBootstrapBtn:U,incomingCall:_e,dialingCall:Le},Ne="/assets/video-chat.c80db452.svg";const Pe=r=>{var o=r,{username:t}=o,n=j(o,["username"]);return e.createElement(m,w({pos:"relative",w:{base:"fill",md:"36rem",lg:"32rem"},px:{base:"0.1rem",md:"0.5rem",lg:"0"},m:{base:"0 auto",lg:"0"},display:{md:"flex"},flexDir:{md:"row-reverse"}},n),e.createElement(m,{w:{base:"14rem",md:"18.6rem",lg:"22rem"},m:{base:"0 auto",md:"0"},pos:"relative",mt:{lg:"3rem"}},e.createElement(m,{w:{base:"14rem",md:"18.6rem",lg:"22rem"},h:{base:"14rem",md:"18.6rem",lg:"22rem"},m:"0 auto",bgColor:"#EBEDF6",borderRadius:"16rem"}),e.createElement(ce,{src:Ne,w:"100%",m:"0 auto",pos:"absolute",top:"50%",transform:"translateY(-50%)",mt:"0.5rem"})),e.createElement(S,{fontSize:{base:"1.5rem",md:"2.2rem",lg:"3rem"},fontWeight:{base:"semibold",md:"normal"},color:"#5564A9",textTransform:"capitalize",pos:"absolute",top:{base:"0"},left:{base:"50%",md:"0"},mt:{base:"-0.5rem",md:"2rem"},transform:{base:"translateX(-78%)",md:"none"},visibility:t?"hidden":"visible"},"Chat with your \xA0",e.createElement("br",null),e.createElement(m,{as:"span",color:"#F58E1F"},"friends")),e.createElement(S,{fontSize:{base:"1.5rem",md:"2.2rem",lg:"3rem"},fontWeight:{base:"semibold",md:"normal"},color:"#7C85A7",w:{base:"full",md:"fit-content"},textAlign:{base:"center",md:"left"},visibility:t?"visible":"hidden",position:"absolute",top:"0",left:{md:"0",lg:"50%"},transform:{lg:"translateX(-50%)"},mt:{base:"-0.5rem",md:"1.8rem"}},"Hi\xA0",e.createElement(m,{as:"br",display:{base:"none",md:"block",lg:"none"}}),"@",t))},te=({name:t,textOnTop:n,title:r,textOnBottom:o,buttonText:a,handleNameInputChange:l,buttonAction:c})=>e.createElement(m,{w:{base:"20.5rem",md:"36rem",lg:"24rem"},m:{base:"0 auto",lg:"0"}},e.createElement(S,{color:"#7C85A7",fontSize:{md:"1.2rem"}},n||""),e.createElement(S,{fontSize:{base:"2.3rem",md:"2.8rem"},color:"#F58E1F"},r),e.createElement(S,{color:"#7C85A7",mt:"-0.5rem",mb:"1.1rem",fontSize:{md:"1.2rem"}},o||""),e.createElement(ie,{type:"text",placeholder:"username",value:t,onChange:l,color:"#7C85A7",bgColor:"#EEEFF7",border:"0",h:"3.5rem",borderRadius:"0.5rem",_focus:{outline:"2px solid rgba(85, 100, 169, 0.6)",outlineOffset:"0"},mb:"1.1rem"}),e.createElement(H,{onClick:c,w:"full",h:"3.5rem",borderRadius:"0.5rem",bgColor:"#5564A9",color:"white",_focus:{boxShadow:"0 0 0 2px rgba(85, 100, 169, 0.6)"}},a)),Ue=({textOnTop:t,textOnBottom:n,title:r,buttonText:o,name:a,handleNameInputChange:l,buttonAction:c})=>e.createElement(te,{textOnTop:t||"Start By",textOnBottom:n||"Choose an easy id",title:r||"Sign In",buttonText:o||"Sign In",name:a,handleNameInputChange:l,buttonAction:c}),ze=({textOnTop:t,textOnBottom:n,title:r,buttonText:o,name:a,handleNameInputChange:l,buttonAction:c})=>e.createElement(te,{textOnTop:t||"Now",textOnBottom:n||"Or wait them to call you",title:r||"Call People",buttonText:o||"Call",name:a,handleNameInputChange:l,buttonAction:c}),We=t=>{const{toggleColorMode:n}=me(),r=Q("dark","light"),o=Q(de,ue);return e.createElement(fe,w({size:"md",fontSize:"lg",variant:"ghost",color:"current",marginLeft:"2",onClick:n,icon:e.createElement(o,null),"aria-label":`Switch to ${r} mode`},t))},$e={username:"",updateUsername:()=>{},friendname:"",updateFriendname:()=>{}},ne=y.exports.createContext($e),q=()=>y.exports.useContext(ne),je=({children:t})=>{const[n,r]=y.exports.useState(""),[o,a]=y.exports.useState("");e.useEffect(()=>{console.log(n)},[n]),e.useEffect(()=>{console.log(o)},[o]);const d={username:n,updateUsername:f=>{r(f)},friendname:o,updateFriendname:f=>{a(f)}};return e.createElement(ne.Provider,{value:d},t)},R=pe({autoConnect:!1,withCredentials:!0});R.onAny((t,...n)=>{let r=null;try{r=n[0].type}finally{console.log(`${t}${r?`:${r}`:""}`,n)}});R.on("connect_error",t=>{console.error("connect_error",t.message),E.error({description:t.message})});R.on("response",t=>{t.type==="socket-connect"&&E.success({description:t.content.description})});const Me={socket:R},re=y.exports.createContext(Me),Y=()=>y.exports.useContext(re),Ve=({children:t})=>{const n={socket:R};return e.createElement(re.Provider,{value:n},t)},He=({history:t})=>{const{socket:n}=Y(),{username:r,friendname:o,updateUsername:a,updateFriendname:l}=q(),[c,d]=e.useState(""),[f,C]=e.useState(!1),[k,i]=e.useState(!1),[p,v]=e.useState(!1),[I,z]=e.useState(n.connected),W=s=>{s.preventDefault(),a(s.target.value)},O=s=>{s.preventDefault(),n.auth={username:r},n.connect()},T=s=>{s.preventDefault(),l(s.target.value)},A=()=>{x.send(n,{type:"call-offer",content:{target:o,cancelling:!0}}),C(!1)},D=()=>{x.send(n,{type:"call-answer",content:{caller:c,accepted:!0}}),v(!0),l(c)},$=()=>{x.send(n,{type:"call-answer",content:{caller:c,accepted:!1}}),d(""),v(!1),i(!1),l("")},_=s=>{if(s.preventDefault(),!n.connected){E.error({description:"You should register first!"});return}C(!0),x.send(n,{type:"call-offer",content:{target:o}})},L=s=>{const{type:u,content:g,success:h}=s;switch(u){case"socket-connect":z(h);break;case"call-offer":h?g.cancelling?(d(""),i(!1),B.swalBootstrapBtn.close()):(d(g.caller),i(!0)):(C(!1),E.error({description:g.description}),B.swalBootstrapBtn.close());break;case"call-answer":h?(B.swalBootstrapBtn.close(),i(!1),v(g.accepted),C(!1)):E.error({description:g.description});break}};return e.useEffect(()=>(n.on("response",L),()=>{n.off("response",L)}),[]),e.useEffect(()=>{f&&B.dialingCall({partner:o,onCancel:A})},[f,C]),e.useEffect(()=>{k&&B.incomingCall({partner:c,onAccept:D,onDeny:$})},[k,i]),e.useEffect(()=>{p&&t.push("/room",{isCaller:!!f})},[p,v]),e.createElement(P,{bgColor:"#f6f6f6",h:"100vh",flexDir:"column",overflowX:"hidden"},e.createElement(m,{boxShadow:"0px 2px 4px rgba(100,100,100,0.5)"},e.createElement(ge,{maxW:"container.lg"},e.createElement(P,{justifyContent:"space-between",alignItems:"center",h:"3.6rem"},e.createElement(m,{fontSize:"1.6rem",fontWeight:"bold"},"W"),e.createElement(m,null,e.createElement(We,null))))),e.createElement(m,{flexGrow:1},e.createElement(m,{position:"relative",top:"50%",transform:"translateY(-50%)",display:{lg:"flex"},justifyContent:{lg:"space-between"},alignItems:{lg:"center"},maxW:{lg:"container.lg"},m:{lg:"0 auto"}},e.createElement(Pe,{username:I?r:""}),e.createElement(m,{maxW:{base:"container.lg",lg:"unset"}},I?e.createElement(ze,{name:o,handleNameInputChange:T,buttonAction:_}):e.createElement(Ue,{name:r,handleNameInputChange:W,buttonAction:O})))))},Xe={iceServers:[{urls:"stun:stun.stunprotocol.org"},{urls:"turn:numb.viagenie.ca",credential:"muazkh",username:"webrtc@live.com"}]},qe=({location:{state:t},history:n})=>{const{friendname:r,updateFriendname:o}=q(),{socket:a}=Y(),[l,c]=e.useState(t.isCaller),[d,f]=e.useState(document.fullscreenElement),C=e.useRef(null),k=e.useRef(null),i=e.useRef(),p=e.useRef(),[v,I]=e.useState();function z(s){s.candidate&&x.send(a,{type:"ice-candidate",content:{friendname:r,candidate:s.candidate}})}function W(s){k.current.srcObject=s.streams[0]}function O(){const s=new RTCPeerConnection(Xe);return s.onicecandidate=z,s.ontrack=W,s}const T=s=>{const{type:u,success:g,content:h}=s;switch(u){case"peer-offer":if(g){i.current=O();const F=new RTCSessionDescription(h.offer);i.current.setRemoteDescription(F).then(()=>{p.current.getTracks().forEach(b=>{i.current.addTrack(b,p.current)})}).then(()=>i.current.createAnswer()).then(b=>i.current.setLocalDescription(b)).then(()=>{x.send(a,{type:"peer-answer",content:{caller:r,answer:i.current.localDescription}})}).catch(b=>console.log(b))}else E.error({description:h.description});break;case"peer-answer":if(g){const F=new RTCSessionDescription(h.answer);i.current.setRemoteDescription(F).catch(b=>console.log(b))}else E.error({description:h.description});break;case"peer-leave":g?_():E.error({description:h.description});break;case"ice-candidate":if(g){const F=new RTCIceCandidate(h.candidate);i.current.addIceCandidate(F).catch(b=>console.log(b))}else E.error({description:h.description});break}};e.useEffect(()=>(navigator.mediaDevices.getUserMedia({audio:!0,video:!0}).then(s=>{C.current.srcObject=s,p.current=s,I(p.current.getVideoTracks()[0].getSettings().aspectRatio),l&&(i.current=O(),i.current.createOffer().then(u=>(i.current.setLocalDescription(u),{target:r,offer:u})).then(u=>{x.send(a,{type:"peer-offer",content:u})}).catch(u=>console.log(u)),p.current.getTracks().forEach(u=>{i.current.addTrack(u,p.current)})),a.on("response",T)}).catch(s=>{console.log(s)}),()=>{a.off("response",T)}),[]);const A=()=>{f(document.fullscreenElement)};e.useEffect(()=>(document.addEventListener("fullscreenchange",A),()=>{document.removeEventListener("fullscreenchange",A)}),[]);function D(){document.documentElement.requestFullscreen()}function $(){document.exitFullscreen()}function _(){k.current.srcObject=null,i.current.close(),i.current.onicecandidate=null,i.current.ontrack=null,p.current.getTracks().forEach(s=>{s.stop()}),p.current=void 0,i.current=void 0,o(""),n.replace("/")}function L(){x.send(a,{type:"peer-leave",content:{target:r}}),_()}return e.createElement(m,{h:"100vh",w:"100vw",overflowX:"hidden"},e.createElement(m,{zIndex:"999",pos:"absolute",top:"0",right:"0",bottom:"0",left:"0",w:"100vw",h:"100vh",bgColor:"rgba(21, 21, 21, 0.5)",onClick:D,d:{base:d===null?"flex":"none",lg:"none"},alignItems:"center",justifyContent:"center",cursor:"pointer"},e.createElement(S,{color:"white",fontSize:"2xl"},"Tap Here To Enter FullScreen")),e.createElement(P,{pos:"absolute",top:{base:"1rem",md:"1.5rem"},left:{base:"1rem",md:"1.5rem"},alignItems:"center"},e.createElement("video",{autoPlay:!0,ref:C,className:`
            rounded-md
            ${v&&v===4/3?"w-32 md:w-44":"w-28 md:w-36"}
          `},e.createElement("track",{kind:"captions"}))),e.createElement(P,{w:"full",h:"full",bgColor:"#F6F6F6",alignItems:"center"},e.createElement("video",{autoPlay:!0,ref:k,className:"h-full my-0 mx-auto"},e.createElement("track",{kind:"captions"})),e.createElement(m,{position:"absolute",bottom:"1.8rem",left:"50%",transform:"translateX(-250%)",d:{base:"none",lg:"block"}},e.createElement(H,{colorScheme:"gray",w:"3.4rem",h:"3.4rem",borderRadius:"20rem",className:"elevation",onClick:d===null?D:$},d===null?e.createElement(he,{className:"text-9xl font-black"}):e.createElement(be,{className:"text-9xl font-black"}))),e.createElement(m,{position:"absolute",bottom:"1.8rem",left:"50%",transform:"translateX(-50%)"},e.createElement(H,{colorScheme:"red",w:"3.4rem",h:"3.4rem",borderRadius:"20rem",className:"elevation",onClick:L},e.createElement(Ee,{className:"text-xl font-black"})))))},Ye=o=>{var a=o,{isAuthenticated:t,authenticationPath:n}=a,r=j(a,["isAuthenticated","authenticationPath"]);return t?e.createElement(Z,w({},r)):e.createElement(Ce,{to:{pathname:n}})},Ge=()=>{const{socket:t}=Y(),{username:n,friendname:r}=q(),o=t.connected===!0&&!!n&&!!r;return e.createElement(we,null,e.createElement(xe,null,e.createElement(Z,{exact:!0,path:"/",component:He}),e.createElement(Ye,{isAuthenticated:o,authenticationPath:"/",path:"/room",component:qe})))},Ke=()=>e.createElement(ve,{theme:Be,resetCSS:!0},e.createElement(Ve,null,e.createElement(je,null,e.createElement(Ge,null)))),Je="modulepreload",oe={},Qe="/",Ze=function(n,r){return!r||r.length===0?n():Promise.all(r.map(o=>{if(o=`${Qe}${o}`,o in oe)return;oe[o]=!0;const a=o.endsWith(".css"),l=a?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${o}"]${l}`))return;const c=document.createElement("link");if(c.rel=a?"stylesheet":Je,a||(c.as="script",c.crossOrigin=""),c.href=o,document.head.appendChild(c),a)return new Promise((d,f)=>{c.addEventListener("load",d),c.addEventListener("error",f)})})).then(()=>n())},et=t=>{t&&t instanceof Function&&Ze(()=>import("./web-vitals.es5.min.acaaa503.js"),[]).then(({getCLS:n,getFID:r,getFCP:o,getLCP:a,getTTFB:l})=>{n(t),r(t),o(t),a(t),l(t)})};Boolean(window.location.hostname==="localhost"||window.location.hostname==="[::1]"||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function tt(){"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(t=>{t.unregister()}).catch(t=>{console.error(t.message)})}ke.render(e.createElement(e.StrictMode,null,e.createElement(Se,null),e.createElement(Ke,null)),document.getElementById("root"));tt();et();
